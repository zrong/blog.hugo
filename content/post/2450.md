+++
title = "八一八 Apple Pay 、NFC 和“云闪付”"
postid = 2450
date = 2016-02-21T21:18:19+08:00
isCJKLanguage = true
toc = false
type = "post"
slug = "applepay-nfc-and-cloud-quick-pass"
aliases = [ "/post/2450.html",]
category = [ "technology",]
tag = [ "ios", "android", "mobile",]
lastmod = 2016-02-21T21:18:19+08:00
attachments = [ "2446", "2447", "2448", "2449",]
+++


Apple Pay 在 2016-02-18 发布，朋友圈和公众号就被刷屏了。其实自从库克同学背着乔老爷子给 iPhone 装上了 NFC 之后，我们就都知道这一天迟早会到来的。

但是 Apple Pay 并不是什么 Apple 的超级武器， **甚至不是什么新东西** 。Apple Pay 的最大得利者，很可能不是 Apple，而是 **中国银联** 。Apple Pay 是中国银联用来对抗支付宝和微信的一把剑。当然，这个合作是双赢的， 中国银联的“云支付”开始支持 Apple Pay， 至少能帮助可怜的 AppStore 服务器承担一点点支付失败绑定银行卡失败的骂名吧……至于说 Apple Pay 这把剑能不能如愿以偿地让中国银联拳打支付宝脚踢微信支付，我们就只能拭目以待了。

如果大家厌烦了这几天各大媒体、各个公众号像教傻X一样教学怎么在 Apple Pay 中绑定银行卡的话，就听我来说说后面的故事。<!--more-->

[TOC]

# 闪付

细心的同学可能会注意到，许多新办理的银行卡上都会有一个 QuickPass 的小标志，越来越多的银联 POS 机上也出现了同样的标志，这就是 [闪付][1] 。

![带有闪付标志的银联卡][51]

从银联的网站可以看出，闪付功能在 2012 年就已经推出，但一直处于不愠不火的状态。除了支持闪付的 POS 机更新缓慢的原因外，另一个重要的原因就是圈存麻烦。

闪付功能虽然包含在银联卡中，但它和公交卡类似，是不记名，和银联账户没有关联的单独账户。要使用闪付功能，必须到指定银行的圈存机（一般是带有闪付功能的ATM机）上向闪付账户中转账。仅这一点就卡住了许多使用者。而且，银联的推广也并不给力。我是在 2015 年下半年才在麦当劳门店看到使用闪付的优惠（用闪付支付半价）。

说白了，闪付就是在银行卡中集成了一个独立的支持 NFC 功能的账户，用于非接触式的小额支付。商家必须有支付闪付的 POS 机才能使用。详见 [银联网站的介绍][1]  。

# NFC

NFC (Near Field Communication) 是一种短距离高频无线电技术，详细的介绍可以参见 [百度百科][2] （很抱歉维基百科打不开） 。

NFC 在手机上也一度非常流行，Google 从 Nexus S 开始就在的亲儿子们里面集成了 NFC 功能。小米 2S/3 也集成了 NFC 芯片。

不过，即使是许多手机都开始支持 NFC 功能，NFC 的主要功能还是限制在帮支持的公交卡充值、以及手机面对面对传之类的简单应用上。可能正因为如此， NFC 在火了一阵子之后沉寂了下来。乔布斯发声说 NFC 是 [a trick][3] 之后，许多厂商似乎打了退堂鼓。小米3就取消了 NFC 的支持，当然在小米5中又加上了。

# 各方博弈

NFC 是天生为支付而生的技术。为什么一直没有发展起来？主要是各方博弈的结果。

## 兼容性

以目前支持最广泛的 NFC 技术 —— 公交卡 为例。为什么有的公交卡可以被 NFC 手机识别甚至充值，有的却不行？ [你的NFC手机为何不能读公交卡？][4] 一文做出了解释：

> 一个完备的NFC产品，应该包括三个部分：NFC硬件、统一的系统接口支持、App。这个结构和蓝牙产品、WiFi产品没啥区别，只是NFC多用于支付领域，所以它的App最好能带支付接口。
> 
> 在这三个部分中，都存在不同的方案，各家互相兼容的状况有差异，其中以硬件部分最甚。
> 
> NFC的硬件部分并不复杂，由CLF（非接前端模块）、射频天线、SE（安全区域）三部分构成。只是读公交卡以及充值，CLF+天线就够了；如果还想把手机App做成电子公交卡（支持空中发卡和空中圈存），那么还需要SE部分。
> 
> 前边提的读卡兼容问题，出在CLF的NFC芯片上。目前国内主流的手机NFC芯片供应商有恩智浦、博通、联发科、三星电子，恩智浦为业内份额第一，博通次之，联发科、三星电子更次，其中三星电子的量主要在Note 4这款机型上。
> 
> 各家芯片公司在NFC的公开标准上，都会有自己的实现，比如有些更兼容老的标准，有的选用了标准内的不同方法，诸如此类等等。如果不能读卡，基本上可以确认是不同芯片之间实现方法不同所造成的兼容问题。
 
上面提到的 NFC 的 SE 部分，目前有三种技术，它们是：

## eSE、NFC-SIM 和 HCE

Apple Pay 属于 eSE，它将加密信息存储在手机独立的安全芯片里。

NFC-SIM 是有运营商主导的安全方案，也就是常见的各类手机钱包，它将加密信息储存在了 SIM 卡里，因此需要去营业厅更换特制的 SIM 卡才能使用。

银联的云闪付则使用的是 HCE (Host Card Emulation) 方案，它被业内人士视为移动支付的未来趋势。它将加密信息交由银行的云端服务器来处理，不需要手机制造商以及运营商参与。HCE 的优势在于减少了对硬件的依赖，既不需要专门的安全芯片，也不需要专用的 SIM 卡。只要手机的 NFC 设计符合规范，就能方便地进行「刷卡购物」了。

顺便说一句， [Android Pay][5] 使用的也是 HCE 方案。

对于HCE方案的理解可以参考这篇文章： [HCE方案全面解析：特点、安全及展望][6]

从上面的分析可以看出，正是不同的厂商之间的博弈，造成了 NFC 的普及困难。也正是由于芯片厂商、移动设备制造商、电信运营商、银行之间的竞争，造成了 NFC 技术的欣欣向荣。

HCE 和 SE方案的比较：

| | HCE 方案 | SE 方案 |
|---- | ---- | ---- |
| 手机NFC支持 | 要求 | 要求 |
| Android 版本 | 4.4 以上 | 2.3 以上 |
| 手机设备硬件 | 通用设备+普通UIM卡| 定制设备+SWP卡 |
| 应用实现 | 手机客户端APP | SE 内的Applet |
| 网络要求 | 需要联机 | 支持离线方式 |
| 应用安全性 | 较高，可以从UIM卡中获取一定信息作为验证 | 高 |
| POS 终端兼容性 | 兼容既有空片受理终端 | 兼容既有空片受理终端 |
| 用户体验 | 一致，无需换卡 | 一致，需换卡 |

# 武汉通

[武汉通][7] 是武汉的公交卡，目前已经可以使用 [QQ 钱包给武汉通充值][8] 。但是，如果乘车不想刷卡而是希望刷手机的话，还必须换用 [武汉通NFC-SIM卡][9] 。

最早的武汉通 SIM 卡是这样的：

![武汉通SIM卡][52]

SIM 卡插在卡槽中，那个黑色的部分则是 NFC 天线。我当时超级想换一张这样的卡，可是跑了3个营业厅都没货，最终放弃。

根据 [手机武汉通][10]  网站的描述，现在的武汉通 SIM 卡貌似不再自带 NFC 天线，而是转而要求手机必须具有 NFC 功能。

从上面的资料看来，武汉通应该采用的是 SE 方案。

详情参见得意生活的帖子： [【武汉通实用帖】不用花钱办公交卡的方法有很多！附办理武汉通手机SIM亲身经历及经验~][11]

# 云闪付

中国银联早在 2015-12-12 就针对安卓手机开通了 “云闪付” 这个业务。也就是说，安卓手机是比 Apple Pay 提前了2个多月实现了 “刷手机” 支付的功能。

云闪付要求手机支持 NFC 功能，并在各个支持云闪付功能的手机银行 App 中进行卡片绑定，然后就和 Apple Pay 一样，可以在 QuickPass 的 POS 机上刷卡了。注意这个 **QuickPass** ！

当然，我的屌丝机红米 Note3 没有 NFC 功能，所以招商银行手机银行的“一闪通”功能（就是云闪付的招行版本，每个银行的名称可能不同）非常客气地提醒我要换手机了：

![招商银行一闪通][53]

简单说，云闪付就是采用 HCE 与 TOKEN 技术，在手机中虚拟出一张银行卡。这张银行卡和真实的银行卡绑定，每次支付的时候 TOKEN 都会变化以保证支付安全。消费时可能要输入银行卡密码。

![云闪付刷手机][54]

如果想看看具体怎么实现的，参考这篇文章： [中国银联联合多方发布“云闪付”刷手机等同刷银行卡][12] 。

# Apple Pay

了解了云闪付，再看看 Apple Pay 。请注意银联官网的文章标题： [银联云闪付开通支持Apple Pay服务][13] 。也就是说， **Apple Pay 是云闪付的一部分** 。

和安卓的云闪付不同的是，Apple Pay 可以使用指纹代替密码来授权。但是在安卓手机普及指纹识别的今天，我相信各大银行的 App 升级支持指纹代替银行卡密码仅仅是时间问题。

另一个不同可能是，Apple Pay 依然利用了 iPhone 手机中的安全芯片。但安卓的云闪付显然就完全基于 HCE 了。

注意！ Apple Pay 在线下也是依赖银联的 **QuickPass** 提供服务的！所以，中国银联和 Apple Pay 是要抱团取暖啊！毕竟在中国，支付宝和微信支付已经跑在前面了。

# 支付宝和微信支付

直接看这个比较好，我就不废话了：

[易图看懂：Apple Pay与支付宝/微信的区别][15]

# 其他

Rubberso 在 [我不用 iPhone，但也想「刷手机购物」怎么办？][14] 中提到：

> 如果你在使用三星 Galaxy S6/S6 edge/S6 edge+ 或者 Galaxy Note5 手机，那可以不用羡慕 iPhone 用户了。
> 
> 在去年 12 月 18 日苹果和银联宣布合作的同时，银联还宣布与 Samsung Pay 达成了合作。除了和  Apple Pay 类似的非接触式（NFC）支付方案，Samsung Pay 还支持 MST 模拟卡方案——这意味着在不支持银联的闪付（QuickPass）的普通 POS 机上，Samsung Pay 依然可以使用。
> 
> 通过手机发射磁力信号，MST 能实现与刷普通磁条卡相同的效果，商家不需要进行任何设备升级正如像三星硬件工程师戈蓝 V 在微博上说的：
> 
> 第一，就应用场景而言～Samsung Pay 支持所有的 Pos 机，而 Apple Pay 只支持带有 NFC 的 (和银联闪付等同)。就统计而言，目前国内支持 NFC 的 POS 大概 700W（感谢银联的大力推广）, 而全国的 POS 机有 1800W 左右，百分之 40 左右，大城市会高一点。

从这点来看，棒子还是挺努力的。

而 [Android Pay][5] 已经哭晕在厕所……

# 参考资料

- [银联“闪付”（Quick Pass）：快捷支付新体验][1]
- [NFC][2]
- [Why does the iPhone 4S lack NFC support?][3]
- [你的NFC手机为何不能读公交卡？][4]
- [Android Pay][5]
- [HCE方案全面解析：特点、安全及展望][6]
- [武汉通联合腾讯财付通在全国率先实现手机QQ钱包充值][8]
- [手机武汉通办理][9]
- [【武汉通实用帖】不用花钱办公交卡的方法有很多！附办理武汉通手机SIM亲身经历及经验~][11]
- [银联云闪付开通支持Apple Pay服务][13]
- [我不用 iPhone，但也想「刷手机购物」怎么办？][14]
- [易图看懂：Apple Pay与支付宝/微信的区别][15]

（全文完）

[1]: http://corporate.unionpay.com/infonewsCenter/infoCompanyNews/file_87029830.html
[2]: http://baike.baidu.com/subview/917495/5282340.htm
[3]: https://www.quora.com/Why-does-the-iPhone-4S-lack-NFC-support/answer/Aaron-Greenspan 
[4]: http://www.leiphone.com/news/201502/LVGgMGoCgSyOYZ74.html
[5]: https://www.android.com/pay/
[6]: http://www.nfcin.com.cn/news/201409/18193147.html
[7]: http://www.whcst.com/
[8]: http://www.whcst.com/yktyw/784.jhtml
[9]: http://www.whnfc.com/applyfor.html
[10]: http://www.whnfc.com/manual.html
[11]: http://www.deyi.com/thread-4507315-1-1.html
[12]: http://paynews.net/article-31387-1.html
[13]: http://corporate.unionpay.com/infonewsCenter/infoCompanyNews/file_126754706.html
[14]: http://mp.weixin.qq.com/s?__biz=MTMwNDMwODQ0MQ==&mid=404191475&idx=1&sn=94a4be25d5c6142e0e39993e585cc0fd&scene=0#rd
[15]: http://tech.163.com/special/applepay11/

[51]: /uploads/2016/02/boc-quickpass.jpg
[52]: /uploads/2016/02/mobile-wht.jpg
[53]: /uploads/2016/02/cmb-cloudquickpass.png
[54]: /uploads/2016/02/cloud-quickpass.jpg
